!function(t){"use strict";var e=function(e,i){this.el=t(e),this.options=t.extend({},t.fn.telewriter.defaults,i),this.text=this.el.text(),this.speed=0,this.input=this.options.input,this.loop=this.options.loop,this.buffer="",this.mark=-1,this.dir=!0,this.pos=0,this.build()};e.prototype={constructor:e,init:function(){var t=this;t.typewrite()},build:function(){this.el.after('<span id="telewriter-cursor">â”ƒ</span>'),this.init()},typewrite:function(){var t=this;if(0==t.dir)return void(t.buffer.length>t.mark?0==t.speed?(t.buffer=t.buffer.substr(0,t.mark),t.el.text(t.buffer),t.dir=!0,setTimeout(t.typewrite.bind(this),0)):(t.buffer=t.buffer.substr(0,t.buffer.length-1),t.el.text(t.buffer),setTimeout(t.typewrite.bind(this),t.speed)):t.dir=!0);if(t.pos>=t.input.length)return void(t.loop&&(t.pos=0,t.mark=-1,t.dir=!0,t.buffer="",setTimeout(t.typewrite.bind(this),0)));var e=t.input[t.pos];if("^"==e)if(t.pos+1>=t.input.length)t.pos+=1,setTimeout(t.typewrite.bind(this),0);else if(/^\^\d+\^/.test(t.input.substr(t.pos))){var i=/\d+/.exec(t.input.substr(t.pos+1))[0],s=i.length,r=parseInt(i);t.pos+=2+s,console.log("speed set from ",t.speed," to ",r),t.speed=r,setTimeout(t.typewrite.bind(this),0)}else"^"==t.input[t.pos+1]?(t.pos+=2,t.buffer+="^",t.el.text(t.buffer),setTimeout(t.typewrite.bind(this),t.speed)):"_"==t.input[t.pos+1]?(t.pos+=2,setTimeout(t.typewrite.bind(this),t.speed)):"*"==t.input[t.pos+1]?(t.pos+=2,t.mark=t.buffer.length,setTimeout(t.typewrite.bind(this),0)):"-"==t.input[t.pos+1]&&(t.pos+=2,t.dir=!1,setTimeout(t.typewrite.bind(this),0));else if(t.dir)if(0==t.speed){var p=t.pos+1;for(p=t.pos+1;p<t.input.length&&"^"!=t.input[p];p++);t.buffer+=t.input.substr(t.pos,p-t.pos),t.pos=p,t.el.text(t.buffer),setTimeout(t.typewrite.bind(this),t.speed)}else t.buffer+=e,t.pos+=1,t.el.text(t.buffer),setTimeout(t.typewrite.bind(this),t.speed);t.options.callback&&t.options.callback()}},t.fn.telewriter=function(i){return this.each(function(){var s=t(this),r=s.data("telewriter"),p="object"==typeof i&&i;r||s.data("telewriter",r=new e(this,p)),"string"==typeof i&&r[i]()})},t.fn.telewriter.defaults={loop:!0}}(jQuery);